---
phase: 03-visual-fx-system
plan: 03
type: execute
wave: 3
depends_on: ["03-02"]
files_modified:
  - crates/omega-bevy/src/simulation/systems.rs
autonomous: true

must_haves:
  truths:
    - "Particles age and despawn correctly"
    - "Visual Cascades update glyphs and colors over time"
    - "Particles physically shrink as they age"
---

<objective>
Implement the visual lifecycle of particles, enabling the requested 'Visual Cascades' and morphing effects.

Output: Lifecycle and cascade systems in omega-bevy.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Implement particle lifecycle and despawning</name>
  <files>
    crates/omega-bevy/src/simulation/systems.rs
  </files>
  <action>
Implement `particle_lifecycle_system`:
- Increment `age` by `dt`.
- Despawn if `age >= max_age`.
  </action>
</task>

<task type="auto">
  <name>Task 2: Implement Visual Cascade logic</name>
  <files>
    crates/omega-bevy/src/simulation/systems.rs
  </files>
  <action>
Implement `particle_visual_cascade_system`:
- Map `age / max_age` progress to `glyphs` and `colors` indices in `VisualCascade`.
- Update `Sprite` texture atlas index (for glyph morphing).
- Update `TextColor` (for color gradients).
- Apply physical shrinking: `Transform.scale` based on progress.
- Handle rotation for `Debris` kinds.
  </action>
</task>

</tasks>

<verification>
- `cargo check -p omega-bevy` passes
</verification>
