---
phase: 03-visual-fx-system
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - crates/omega-bevy/src/simulation/systems.rs
autonomous: true

must_haves:
  truths:
    - "Particles move smoothly in 3D logical space"
    - "Gasses have a natural upward velocity"
    - "Particles react to the WindGrid resource"
    - "Particles bounce off structural obstacles"
---

<objective>
Implement advanced particle kinematics and physical interactions with the environment.

Output: Particle physics and wind drift systems in omega-bevy.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Implement particle physics system</name>
  <files>
    crates/omega-bevy/src/simulation/systems.rs
  </files>
  <action>
Implement `particle_physics_system`:
- Update `logical_pos` using `velocity` and `dt`.
- Apply gravity to `velocity.z` for `Debris` or `Ash` kinds.
- Apply upward drift (Z-axis) for `Smoke` and `Steam`.
- Handle wall bouncing: Check `logical_pos` against `CaGrid` obstacles. If collision, reverse velocity component with damping.
  </action>
</task>

<task type="auto">
  <name>Task 2: Implement wind drift system</name>
  <files>
    crates/omega-bevy/src/simulation/systems.rs
  </files>
  <action>
Implement `particle_wind_drift_system`:
- Peek at `WindGrid` at particle's X, Y location.
- Apply force to `velocity` based on `WindVector` and particle `weight`.
  </action>
</task>

</tasks>

<verification>
- `cargo check -p omega-bevy` passes
</verification>
